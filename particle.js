class Particle{constructor(t,i){this.position=createVector(t.x,t.y),this.velocity=createVector(0,0),this.type=i}applyInternalForces(t){let i,e=createVector(0,0),o=createVector(0,0),h=createVector(0,0);for(let o of t.swarm)if(o!=this){if(h.mult(0),h=o.position.copy(),h.sub(this.position),h.x>.5*width&&(h.x-=width),h.x<-.5*width&&(h.x+=width),h.y>.5*height&&(h.y-=height),h.y<-.5*height&&(h.y+=height),i=h.mag(),h.normalize(),i<t.internalMins[this.type][o.type]){let s=h.copy();s.mult(-3*abs(t.internalForces[this.type][o.type])*K),s.mult(map(i,0,t.internalMins[this.type][o.type],1,0)),e.add(s)}if(i<t.internalRadii[this.type][o.type]){let s=h.copy();s.mult(t.internalForces[this.type][o.type]*K),s.mult(map(i,0,t.internalRadii[this.type][o.type],1,0)),e.add(s)}}o=e.copy(),this.velocity.add(o),this.position.add(this.velocity),this.position.x=(this.position.x+width)%width,this.position.y=(this.position.y+height)%height,this.velocity.mult(friction)}applyExternalForces(t){let i,e=createVector(0,0),o=createVector(0,0),h=createVector(0,0);for(let o of swarm)if(o!=t)for(let s of o.swarm){if(h.mult(0),h=s.position.copy(),h.sub(this.position),h.x>.5*width&&(h.x-=width),h.x<-.5*width&&(h.x+=width),h.y>.5*height&&(h.y-=height),h.y<-.5*height&&(h.y+=height),i=h.mag(),h.normalize(),i<t.externalMins[this.type][s.type]){let o=h.copy();o.mult(-3*abs(t.externalForces[this.type][s.type])*K),o.mult(map(i,0,t.externalMins[this.type][s.type],1,0)),e.add(o)}if(i<t.externalRadii[this.type][s.type]){let o=h.copy();o.mult(t.externalForces[this.type][s.type]*K),o.mult(map(i,0,t.externalRadii[this.type][s.type],1,0)),e.add(o)}}o=e.copy(),this.velocity.add(o),this.position.add(this.velocity),this.position.x=(this.position.x+width)%width,this.position.y=(this.position.y+height)%height,this.velocity.mult(friction)}display(){fill(this.type*colorStep,100,100),circle(this.position.x,this.position.y,8)}}